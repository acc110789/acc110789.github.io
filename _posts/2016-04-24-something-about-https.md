---
layout: post
title: https的基本原理
tag: http
category: tech
---

## {{ page.title }}

### 公钥密码体制

在公钥密码体制中,密钥是成对出现的,所有有两个密钥,将其中一个密钥称为公钥,另一个称为
私钥.公钥密码加解密有以下特点:

> 由两个密钥其中一个加密后得到的密文只能由另一把密钥解开.比如我现在用公钥加密明文后得到
的密文只能用私钥解开,而由私钥加密后的密文也只能用公钥解开.

一般是这样使用公钥密码体制的:

> 私钥由自己保存,公钥公开给所有人.

使用公钥密码能达到两个目标:

* 签名认证
* 安全通信

下面解释为什么使用公钥密码能达到上述的两个目标:

A现在要宣布一个消息,于是A将这个消息用自己的公钥加密后发送出去,其它人都可以用A的公钥解密
查看消息内容,这个时候A就无法抵赖说他没有发送这个消息,因为只有用你的公钥才能解密开收到的
密文,所以一定是A用自己的私钥加密产生的密文,这个就达到了A签名认证的功能(A到时候不能抵赖).
<br/>
A想跟B进行通信,但是A不想要通信内容被泄漏,于是A用B的公钥加密信息,这样密文就只有B的私钥才能
解开了.<br/>

实际上的情况要稍微复杂一些:

实际上签名过程是这样的:假设要签名的明文是`plain`,`H()`是哈希函数,私钥加密是`E()`,公钥加密是`D()`,
|是级连函数.则A发送的签名数据是`DATA=plain|E(H(plain))`.
接收者接收到两个东西,一个是是`plain`,一个是`E(H(plain))`,接受者对`plain`进行哈希,
得到`value1=H(plain)`,然后对`E(H(plain))`解密得到`value2=H(plain)`,如果`value1`
和`value2`相等,则表明`plain`的确是发送者发出的,他不能抵赖,但是如果不相等,则可能是
中途数据被篡改了,或者根本就不是发送者发出的.

由于公钥密码体制的加解密速度较慢,其实际的应用场景一半是对称密钥的协商过程.

<br/>
### HTTPS

https的大概过程是这样的:

1. 客户端发起连接
2. 服务器把自己的证书发给客户端
3. 客户端发现这个证书是收到信任的,于是自己想一个对称密钥,然后把对称密钥,对称密钥的算法
打包用证书里面的公钥解密发出去
4. 这个数据只有服务器才能解密,服务器收到这个数据之后,就利用这个对称密钥跟客户端进行通信

实际的过程比上述过程略微复杂一点.
